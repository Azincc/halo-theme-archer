<th:block th:replace="~{modules/layout :: html(~{::content}, ~{::page_js}, ${tag.spec.displayName + ' - Tags'}, 'tag')}">
  <th:block th:fragment="content">
    <main class="main tag-page">

      <!-- 主体区域 -->
      <div class="page-body">
        <!-- 左侧个人资料 -->
        <div th:replace="~{fragment/profile :: profile-card}">
        </div>

        <!-- 右侧文章流 -->
        <section class="content-wrapper">
          <th:block th:each="post, postStat : ${posts.items}">
            <article class="index-post">
              <a class="abstract-title" th:href="${post.status.permalink}">
                <span class="iconfont-archer stick-top" th:if="${post.spec.pinned}">&#xe63d;</span>
                <span class="abstract-title-text" th:text="${post.spec.title ?: '[Untitled Post]'}">Post Title</span>
              </a>

              <div class="abstract-post-meta">
                <div>
                  <span class="iconfont-archer abstract-calander">&#xe616;</span>
                  <span th:text="${#dates.format(post.spec.publishTime, 'yyyy/MM/dd')}">2024/01/01</span>
                  <th:block th:if="${not #lists.isEmpty(post.categories)} and ${theme.config.style.show_categories}">
                    <span class="post-category" th:data-categories="${post.categories[0].metadata.name}">
                      <span class="iconfont-archer post-category-icon">&#xe606;</span>
                      <span class="post-category-text" th:text="${post.categories[0].spec.displayName}">Category</span>
                    </span>
                  </th:block>
                </div>
                <div class="abstract-tags" th:if="${not #lists.isEmpty(post.tags)}">
                  <a class="post-tag"
                     th:each="postTag : ${post.tags}"
                     th:href="${postTag.status.permalink}"
                     th:data-tags="${postTag.metadata.name}"
                     th:text="${postTag.spec.displayName}">Tag</a>
                </div>
              </div>

              <div class="abstract-content" th:if="${post.status.excerpt}" th:utext="${post.status.excerpt}"></div>
              <div class="abstract-content" th:unless="${post.status.excerpt}"
                   th:with="truncateLen=${theme.config.style.truncate_length != null ? theme.config.style.truncate_length : 300},
                            fallbackExcerpt=${post.spec.excerpt?.raw},
                            sanitizedExcerpt=${fallbackExcerpt != null ? #strings.replace(#strings.replace(fallbackExcerpt, '<', ' <'), '>', '> ') : ''}">
                <span th:if="${not #strings.isEmpty(sanitizedExcerpt)}"
                      th:text="${#strings.abbreviate(sanitizedExcerpt, truncateLen)}"></span>
                <span th:if="${#strings.isEmpty(sanitizedExcerpt)}"
                      th:text="${#strings.abbreviate(post.spec.title ?: '[Untitled Post]', truncateLen)}"></span>
              </div>

              <div class="abstract-read-more-button" th:if="${theme.config.style.read_more_button}">
                <a th:href="${post.status.permalink}">
                  阅读更多 <span class="iconfont-archer">&#xe600;</span>
                </a>
              </div>
            </article>
          </th:block>

          <th:block
            th:with="
              slug=${tag.metadata.name},
              firstPageUrl=@{|/tags/${slug}|},
              pagePrefix=@{|/tags/${slug}/page/|}"
            th:replace="~{fragment/navigation :: page-nav(pageData=${posts}, firstPageUrl=${firstPageUrl}, pageUrlPrefix=${pagePrefix}, pageUrlSuffix='/')}"
          />

          <!-- 无文章提示 -->
          <div class="no-posts" th:if="${posts.total == 0}" style="text-align: center; padding: 3rem; color: #999;">
            <p>该标签下暂无文章</p>
          </div>
        </section>
      </div>
    </main>
  </th:block>
  <th:block th:fragment="page_js"></th:block>
</th:block>
