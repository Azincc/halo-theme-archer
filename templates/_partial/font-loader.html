<th:block th:fragment="fontLoader">
  <script th:inline="javascript">
    function getBrowserVersions() {
      var u = navigator.userAgent;
      return {
        userAgent: u,
        uc: u.indexOf('UCBrowser') > -1
      };
    }
    var browser = {
      versions: getBrowserVersions()
    };
    function fontLoaded() {
      if (document.getElementsByClassName('site-intro-meta').length) {
        var introTitle = document.getElementsByClassName('intro-title')[0];
        var introSubtitle = document.getElementsByClassName('intro-subtitle')[0];
        if (introTitle) {
          introTitle.classList.add('intro-fade-in');
        }
        if (introSubtitle) {
          introSubtitle.classList.add('intro-fade-in');
        }
        var postIntros = document.getElementsByClassName('post-intros')[0];
        if (postIntros) {
          postIntros.classList.add('post-fade-in');
        }
      }
    }
    function asyncCb() {
      if (browser.versions.uc) {
        fontLoaded();
      } else if (window.WebFont) {
        window.WebFont.load({
          custom: {
            families: ['Oswald-Regular']
          },
          active: fontLoaded,
          inactive: fontLoaded,
          timeout: 5000
        });
      }
    }
    function asyncErr() {
      console.warn('script load from CDN failed, will load local script');
    }
    function async(u, cb, err) {
      var d = document,
        t = 'script',
        o = d.createElement(t),
        s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (cb) {
        o.addEventListener(
          'load',
          function (e) {
            cb(null, e);
          },
          false
        );
      }
      if (err) {
        o.addEventListener(
          'error',
          function (e) {
            err(null, e);
          },
          false
        );
      }
      s.parentNode.insertBefore(o, s);
    }
    var asyncLoadWithFallBack = function (arr, success, reject) {
      var currReject = function () {
        reject();
        arr.shift();
        if (arr.length) async(arr[0], success, currReject);
      };
      async(arr[0], success, currReject);
    };
    asyncLoadWithFallBack(
      [
        'https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js',
        'https://cdn.bootcdn.net/ajax/libs/webfont/1.6.28/webfontloader.js',
        '[[ @{/assets/lib/webfontloader.min.js} ]]'
      ],
      asyncCb,
      asyncErr
    );
  </script>
</th:block>
